{"version":3,"file":"index.cjs.js","sources":["../src/noisy-notification/noisy-notification.js"],"sourcesContent":["export class NoisyNotification extends HTMLElement {\r\n    constructor() {\r\n        super();\r\n        this.attachShadow({ mode: 'open' });\r\n        this.loadTemplate();\r\n        this.noiseTexture = null;\r\n        this.timer = null;\r\n        this.isPaused = false;\r\n        this.isExpanded = false;\r\n        this.startTime = Date.now();\r\n    }\r\n\r\n    static get observedAttributes() {\r\n        return ['state', 'tint', 'duration'];\r\n    }\r\n\r\n    attributeChangedCallback(name, oldValue, newValue) {\r\n        if (name === 'state') {\r\n            this.updateState();\r\n        } else if (name === 'tint') {\r\n            this.updateTint();\r\n        } else if (name === 'duration') {\r\n            this.updateDuration();\r\n        }\r\n    }\r\n\r\n    connectedCallback() {\r\n        this.generateNoiseTexture();\r\n        this.startTimer();\r\n        this.addEventListeners();\r\n    }\r\n\r\n    disconnectedCallback() {\r\n        this.clearTimer();\r\n        this.removeEventListeners();\r\n    }\r\n\r\n    async loadTemplate() {\r\n        const response = await fetch('draft/noisy-notification.html');\r\n        const template = await response.text();\r\n        this.shadowRoot.innerHTML = template;\r\n        this.addStyles();\r\n    }\r\n\r\n    addStyles() {\r\n        fetch('draft/noisy-notification.css')\r\n            .then(response => response.text())\r\n            .then(css => {\r\n                const style = document.createElement('style');\r\n                style.textContent = css;\r\n                this.shadowRoot.appendChild(style);\r\n            });\r\n    }\r\n\r\n    addEventListeners() {\r\n        this.shadowRoot.querySelector('.close-button').addEventListener('click', () => this.dismissState());\r\n        this.shadowRoot.querySelector('.expand-button').addEventListener('click', () => this.toggleExpand());\r\n        this.addEventListener('mouseover', () => this.pauseTimer());\r\n        this.addEventListener('mouseleave', () => this.resumeTimer());\r\n        this.addEventListener('touchstart', () => this.pauseTimer());\r\n        this.addEventListener('touchend', () => this.resumeTimer());\r\n    }\r\n\r\n    removeEventListeners() {\r\n        this.shadowRoot.querySelector('.close-button').removeEventListener('click', () => this.dismissState());\r\n        this.shadowRoot.querySelector('.expand-button').removeEventListener('click', () => this.toggleExpand());\r\n        this.removeEventListener('mouseover', () => this.pauseTimer());\r\n        this.removeEventListener('mouseleave', () => this.resumeTimer());\r\n        this.removeEventListener('touchstart', () => this.pauseTimer());\r\n        this.removeEventListener('touchend', () => this.resumeTimer());\r\n    }\r\n\r\n    generateNoiseTexture() {\r\n        const canvas = document.createElement('canvas');\r\n        const ctx = canvas.getContext('2d');\r\n        const width = 512;\r\n        const height = 512;\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n\r\n        function prng(seed) {\r\n            let value = seed;\r\n            return function () {\r\n                value = (value * 9301 + 49297) % 233280;\r\n                return value / 233280;\r\n            };\r\n        }\r\n\r\n        function generateNoise(ctx, width, height, seed) {\r\n            const imageData = ctx.createImageData(width, height);\r\n            const data = imageData.data;\r\n            const random = prng(seed);\r\n\r\n            for (let i = 0; i < data.length; i += 4) {\r\n                const value = Math.floor(random() * 255);\r\n                data[i] = value;\r\n                data[i + 1] = value;\r\n                data[i + 2] = value;\r\n                data[i + 3] = 50;\r\n            }\r\n\r\n            ctx.putImageData(imageData, 0, 0);\r\n        }\r\n\r\n        generateNoise(ctx, width, height, 42);\r\n        this.noiseTexture = canvas.toDataURL();\r\n        this.shadowRoot.querySelector('.noise').style.backgroundImage = `url(${this.noiseTexture})`;\r\n    }\r\n\r\n    startTimer() {\r\n        if (this.isCollapsible) {\r\n            this.clearTimer();\r\n            this.startTime = Date.now();\r\n            this.timer = setTimeout(() => this.dismissState(), this.duration);\r\n        }\r\n    }\r\n\r\n    clearTimer() {\r\n        if (this.timer) {\r\n            clearTimeout(this.timer);\r\n            this.timer = null;\r\n        }\r\n    }\r\n\r\n    pauseTimer() {\r\n        if (this.isCollapsible && !this.isPaused) {\r\n            this.isPaused = true;\r\n            this.clearTimer();\r\n        }\r\n    }\r\n\r\n    resumeTimer() {\r\n        if (this.isCollapsible && this.isPaused) {\r\n            this.isPaused = false;\r\n            this.startTimer();\r\n        }\r\n    }\r\n\r\n    dismissState() {\r\n        this.clearTimer();\r\n        this.dispatchEvent(new CustomEvent('dismissed'));\r\n    }\r\n\r\n    toggleExpand() {\r\n        this.isExpanded = !this.isExpanded;\r\n        this.shadowRoot.querySelector('.expand-button img').src = this.isExpanded ? 'collapse.svg' : 'expand.svg';\r\n        this.style.height = this.isExpanded ? 'auto' : '50px';\r\n    }\r\n\r\n    updateState() {\r\n        this.style.backgroundColor = this.getTintedColor();\r\n    }\r\n\r\n    updateTint() {\r\n        this.style.backgroundColor = this.getTintedColor();\r\n    }\r\n\r\n    updateDuration() {\r\n        this.clearTimer();\r\n        this.startTimer();\r\n    }\r\n\r\n    getTintedColor() {\r\n        const colorMap = {\r\n            danger: '#FF4500',\r\n            warning: '#F6C737',\r\n            'info-active': '#52C74D',\r\n            'info-inactive': '#5E7A74',\r\n        };\r\n\r\n        let color = colorMap[this.getAttribute('state')] || '#000';\r\n        return this.tintColor(color, parseInt(this.getAttribute('tint')) || 0);\r\n    }\r\n\r\n    tintColor(color, tintLevel) {\r\n        const tints = {\r\n            0: '00',\r\n            1: '33',\r\n            2: '66',\r\n            3: '99',\r\n        };\r\n\r\n        return `${color}${tints[tintLevel]}`;\r\n    }\r\n\r\n    get isCollapsible() {\r\n        return ['info', 'warning', 'success'].includes(this.getAttribute('state'));\r\n    }\r\n\r\n    get duration() {\r\n        return parseInt(this.getAttribute('duration')) || 5000;\r\n    }\r\n}\r\n\r\ncustomElements.define('noisy-notification', NoisyNotification);\r\n"],"names":["NoisyNotification","HTMLElement","constructor","super","this","attachShadow","mode","loadTemplate","noiseTexture","timer","isPaused","isExpanded","startTime","Date","now","observedAttributes","attributeChangedCallback","name","oldValue","newValue","updateState","updateTint","updateDuration","connectedCallback","generateNoiseTexture","startTimer","addEventListeners","disconnectedCallback","clearTimer","removeEventListeners","response","fetch","template","text","shadowRoot","innerHTML","addStyles","then","css","style","document","createElement","textContent","appendChild","querySelector","addEventListener","dismissState","toggleExpand","pauseTimer","resumeTimer","removeEventListener","canvas","ctx","getContext","width","height","seed","imageData","createImageData","data","random","value","prng","i","length","Math","floor","putImageData","generateNoise","toDataURL","backgroundImage","isCollapsible","setTimeout","duration","clearTimeout","dispatchEvent","CustomEvent","src","backgroundColor","getTintedColor","color","danger","warning","getAttribute","tintColor","parseInt","tintLevel","includes","customElements","define"],"mappings":"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"}